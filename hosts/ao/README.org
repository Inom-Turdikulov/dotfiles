#+TITLE: Ao
#+DATE:  December 16, 2014

* Overview
Mac Mini 2014. Used as a low-power home server.

* Specs
https://support.apple.com/kb/SP710?locale=en_CA

* Installation
** Set up root file system
#+BEGIN_SRC sh
parted /dev/sda -- mklabel gpt
parted /dev/sda -- mkpart ESP fat32 1MiB 512MiB
parted /dev/sda -- mkpart primary 512MiB 100%
parted /dev/sda -- set 1 boot on
mkfs.fat -F32 -n BOOT /dev/sda1
mkfs.ext4 -L nixos /dev/sda2

# Set up encrypted volume
parted /dev/sdb -- mklabel gpt
parted /dev/sdb -- mkpart primary 2048s 100%
cryptsetup -v -y luksFormat /dev/sdb1
cryptsetup luksOpen /dev/sdb1 backup
mkfs.ext4 -L backup /dev/sdb1
#+END_SRC

** Mount drives
#+BEGIN_SRC sh
mount /dev/disk/by-label/nixos /mnt
mkdir -p /mnt/boot
mount /dev/disk/by-label/BOOT /mnt/boot
mount /dev/mapper/backup /mnt/backup
#+END_SRC
